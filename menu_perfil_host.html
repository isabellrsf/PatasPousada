<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Menu do Anfitrião • Patas Pousada</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Nunito:wght@200..1000&family=Parkinsans:wght@300..800&display=swap');

:root{
  --brand:#e2725b;
  --brand-strong:#d45f47;
  --ink:#1f2937;
  --muted:#6b7280;
  --bg:#f3f4f6;
  --white:#fff;
  --radius:12px;
  --shadow:0 4px 12px rgba(0,0,0,.06);
  --line:#e5e7eb;
  --chip:#fff0ec;
  --chip-border:#ffd8cf;
  --transition:.2s cubic-bezier(.25,.8,.25,1);
}

*{box-sizing:border-box;margin:0;padding:0}
html,body{max-width:100%;overflow-x:hidden}
body{
  font-family:Nunito,system-ui,Arial,sans-serif;
  background:var(--bg);
  color:var(--ink);
  line-height:1.5;
}
a{text-decoration:none;color:inherit}
button{font-family:inherit}
:focus-visible{outline:3px solid rgba(226,114,91,.35); outline-offset:2px}

/* HEADER */
header{
  display:flex;
  justify-content:center;
  background:rgba(255,255,255,.95);
  box-shadow:0 1px 3px rgba(0,0,0,.05);
  position:sticky;
  top:0;
  z-index:100;
  backdrop-filter:blur(8px);
}
.nav{
  max-width:1100px;
  width:100%;
  padding:16px 24px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:16px;
}
.logo{
  display:flex;
  align-items:center;
  gap:10px;
  font-family:Parkinsans,sans-serif;
  font-weight:800;
  font-size:1.35rem;
  color:var(--brand);
  flex: 0 0 auto;
}
.logo img{width:34px;height:34px}

/* links (desktop) */
.nav ul{
  list-style:none;
  display:flex;
  gap:24px;
  align-items:center;
}
.nav a.link{
  font-family:Parkinsans,sans-serif;
  font-weight:600;
  color:#4b5563;
}
.nav a.link:hover{color:var(--brand)}

/* Hamburger (mobile) */
.menu-toggle{
  display:none;
  width:44px;
  height:44px;
  border-radius:14px;
  border:1px solid var(--line);
  background:#fff;
  color:#4b5563;
  cursor:pointer;
  align-items:center;
  justify-content:center;
  box-shadow:0 2px 8px rgba(0,0,0,.05);
  transition: transform var(--transition), box-shadow var(--transition), border-color var(--transition), color var(--transition);
  -webkit-tap-highlight-color: transparent;
}
.menu-toggle:hover{
  border-color: rgba(226,114,91,.35);
  color: var(--brand-strong);
  box-shadow:0 8px 20px rgba(0,0,0,.08);
  transform: translateY(-1px);
}
.menu-toggle:active{ transform: translateY(0); }

/* dropdown menu (mobile) */
.mobile-menu{
  position: fixed;
  inset: 0;
  background: rgba(17,24,39,.35);
  display: none;
  z-index: 999;
  backdrop-filter: blur(3px);
}
.mobile-menu.is-open{ display:block; }

.mobile-menu__panel{
  position:absolute;
  top: 72px;
  right: 12px;
  left: 12px;
  background:#fff;
  border:1px solid var(--line);
  border-radius:16px;
  box-shadow:0 16px 50px rgba(0,0,0,.16);
  overflow:hidden;
}

.mobile-menu__links{
  display:flex;
  flex-direction:column;
  padding:10px;
  gap:6px;
}
.mobile-menu__links a{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  padding:12px 12px;
  border-radius:14px;
  font-family:Parkinsans,sans-serif;
  font-weight:700;
  color:#374151;
  background:#fff;
  transition: background var(--transition), color var(--transition), transform var(--transition);
}
.mobile-menu__links a i{ color:#9ca3af; }
.mobile-menu__links a:hover{
  background:#fff7f5;
  color: var(--brand-strong);
  transform: translateX(2px);
}
.mobile-menu__foot{
  border-top:1px solid var(--line);
  padding:10px;
  display:flex;
  justify-content:flex-end;
}
.mobile-menu__close{
  border:1px solid var(--line);
  background:#fff;
  border-radius:12px;
  padding:10px 12px;
  cursor:pointer;
  font-weight:800;
  color:#6b7280;
}
.mobile-menu__close:hover{ color: var(--brand-strong); border-color: rgba(226,114,91,.35); }

/* USER MENU */
.user{position:relative; flex:0 0 auto;}
.user__trigger{
  display:flex;
  align-items:center;
  gap:10px;
  padding:6px 12px 6px 6px;
  border-radius:40px;
  cursor:pointer;
  border: 1px solid transparent;
  transition: background var(--transition), border-color var(--transition), box-shadow var(--transition);
}
.user__trigger:hover{
  background:#fff;
  border-color: var(--line);
  box-shadow:var(--shadow);
}
.user__avatar-img{
  width:40px;height:40px;
  border-radius:50%;
  object-fit:cover;
  display:none;
  border:1px solid var(--line);
}
.badge{
  width:40px;height:40px;
  border-radius:50%;
  background:var(--chip);
  color:var(--brand);
  display:grid;
  place-items:center;
  font-weight:800;
}
.user__trigger span{
  max-width:140px;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  font-weight:800;
}
.user__dropdown{
  position:absolute;
  right:0;
  top:calc(100% + 8px);
  background:#fff;
  border-radius:14px;
  border:1px solid var(--line);
  box-shadow:0 10px 25px rgba(0,0,0,.1);
  width:220px;
  padding:6px;
  opacity:0;
  visibility:hidden;
  transform:translateY(10px);
  transition:.2s;
}
.user:hover .user__dropdown{
  opacity:1;
  visibility:visible;
  transform:translateY(0);
}
.user__item{
  display:flex;
  gap:10px;
  align-items:center;
  padding:10px 14px;
  border-radius:10px;
  font-size:.85rem;
  font-weight:800;
  color:#4b5563;
}
.user__item:hover{
  background:#f9fafb;
  color:var(--brand);
}

/* CONTEÚDO */
.wrap{
  max-width:800px;
  margin:40px auto;
  padding:0 24px;
  min-height:60vh;
}
.back-btn{
  display:inline-flex;
  gap:8px;
  align-items:center;
  margin-bottom:24px;
  padding:10px 16px;
  border-radius:999px;
  border:1px solid var(--line);
  background:#fff;
  color:var(--muted);
  font-weight:800;
  cursor:pointer;
  transition: transform var(--transition), border-color var(--transition), color var(--transition), box-shadow var(--transition);
  -webkit-tap-highlight-color: transparent;
}
.back-btn:hover{
  border-color:rgba(226,114,91,.35);
  color:var(--brand-strong);
  box-shadow:0 10px 22px rgba(0,0,0,.08);
  transform:translateY(-1px);
}

.title{
  font:800 1.8rem Parkinsans,sans-serif;
  text-align:center;
}
.lead{
  text-align:center;
  color:var(--muted);
  margin:12px auto 40px;
  max-width:520px;
}

.grid{
  display:grid;
  gap:16px;
}
@media(min-width:600px){
  .grid{grid-template-columns:1fr 1fr}
}
.card{
  background:#fff;
  border-radius:16px;
  padding:24px;
  box-shadow:var(--shadow);
  display:flex;
  flex-direction:column;
  align-items:center;
  text-align:center;
  transition: transform var(--transition), box-shadow var(--transition);
}
.card:hover{
  transform:translateY(-4px);
  box-shadow:0 12px 24px rgba(0,0,0,.08);
}
.icon-box{
  width:56px;height:56px;
  border-radius:50%;
  background:var(--chip);
  color:var(--brand);
  display:grid;
  place-items:center;
  font-size:1.4rem;
}
.card h3{
  font:800 1.1rem Parkinsans,sans-serif;
  margin-top:12px;
}
.card p{
  font-size:.85rem;
  color:var(--muted);
}

/* =========================
   MOBILE TUNING
   ========================= */
@media (max-width: 860px){
  .nav{
    padding:12px 14px;
  }

  /* oculta os links no topo e ativa hambúrguer */
  .nav ul{ display:none; }
  .menu-toggle{ display:inline-flex; }

  /* deixa o logo menor e evita quebrar */
  .logo{ font-size:1.2rem; }
  .logo img{ width:32px; height:32px; }

  /* usuário mais compacto */
  .user__trigger{
    padding:6px 10px 6px 6px;
  }
  .user__trigger span{
    max-width:92px;
    font-size:.95rem;
  }

  /* conteúdo com respiro melhor no celular */
  .wrap{
    margin:22px auto;
    padding:0 14px;
  }
  .title{ font-size:1.55rem; }
  .lead{ margin:10px auto 22px; }

  /* cards em 1 coluna no mobile */
  .grid{ grid-template-columns:1fr; }
}

/* iPhone safe area */
@supports(padding: env(safe-area-inset-top)){
  header{
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
}
</style>
</head>

<body>

<header>
  <nav class="nav" aria-label="Navegação principal">
    <a class="logo" href="home_host.html">
      <img src="https://images.vexels.com/media/users/3/202255/isolated/preview/a095b3fe28f3c9febbf176089e2d7e08-pegada-de-cachorro-com-osso-de-coracao-rosa-plana.png" alt="Patas Pousada">
      Patas Pousada
    </a>

    <!-- Links (desktop) -->
    <ul aria-label="Links">
      <li><a class="link" href="reservas_host.html">Reservas</a></li>
      <li><a class="link" href="ajuda.html">Ajuda</a></li>
    </ul>

    <!-- Botão hambúrguer (mobile) -->
    <button class="menu-toggle" id="menuToggle" type="button" aria-label="Abrir menu" aria-controls="mobileMenu" aria-expanded="false">
      <i class="fa-solid fa-bars"></i>
    </button>

    <div class="user">
      <div class="user__trigger" role="button" tabindex="0" aria-label="Menu do usuário">
        <img id="userAvatar" class="user__avatar-img" alt="Avatar do anfitrião">
        <div class="badge" id="userInitial">H</div>
        <span id="userName">Anfitrião</span>
        <i class="fa-solid fa-chevron-down" style="font-size:.8rem;color:#9ca3af;"></i>
      </div>

      <div class="user__dropdown" aria-label="Ações do usuário">
        <a class="user__item" href="perfil_host.html"><i class="fa-solid fa-user-pen"></i> Editar perfil</a>
        <a class="user__item" href="#" id="btnLogout"><i class="fa-solid fa-arrow-right-from-bracket"></i> Sair</a>
      </div>
    </div>
  </nav>
</header>

<!-- Menu mobile (overlay) -->
<div class="mobile-menu" id="mobileMenu" aria-hidden="true">
  <div class="mobile-menu__panel" role="dialog" aria-modal="true" aria-label="Menu">
    <div class="mobile-menu__links">
      <a href="home_host.html">
        <span><i class="fa-solid fa-calendar-check" style="margin-right:10px"></i> Reservas</span>
        <i class="fa-solid fa-chevron-right"></i>
      </a>
      <a href="ajuda.html">
        <span><i class="fa-solid fa-circle-question" style="margin-right:10px"></i> Ajuda</span>
        <i class="fa-solid fa-chevron-right"></i>
      </a>
    </div>
    <div class="mobile-menu__foot">
      <button class="mobile-menu__close" id="menuClose" type="button">Fechar</button>
    </div>
  </div>
</div>

<main class="wrap">

<button class="back-btn" onclick="location.href='home_host.html'">
  <i class="fa-solid fa-arrow-left"></i> Voltar para o painel
</button>

<h1 class="title">Gerenciar Perfil</h1>
<p class="lead">Gerencie seus dados de anfitrião e a segurança da sua conta.</p>

<div class="grid">
  <a class="card" href="editar_perfil_host.html">
    <div class="icon-box"><i class="fa-solid fa-user-gear"></i></div>
    <h3>Dados do anfitrião</h3>
    <p>Informações públicas, endereço e descrição.</p>
  </a>

  <a class="card" href="alterar_senha_host.html">
    <div class="icon-box"><i class="fa-solid fa-shield-halved"></i></div>
    <h3>Segurança</h3>
    <p>Altere sua senha e dados de acesso.</p>
  </a>
</div>

</main>

<script>
const sb = supabase.createClient(
  "https://nwbgzokttjgkipwzfgzc.supabase.co",
  "sb_publishable_wn2dxmpI7gFOx4nLh5oHqg_Qlc4Q0lQ"
);

const userName = document.getElementById('userName');
const userInitial = document.getElementById('userInitial');
const userAvatar = document.getElementById('userAvatar');
const btnLogout = document.getElementById('btnLogout');

function initials(name){
  if(!name) return 'H';
  return name.split(' ').map(n=>n[0]).join('').slice(0,2).toUpperCase();
}

async function init(){
  const { data:{ user } } = await sb.auth.getUser();
  if(!user) return location.href="cadastrarouentrar.html";

  const { data } = await sb
    .from('hosts')
    .select('full_name, avatar_url')
    .eq('id', user.id)
    .maybeSingle();

  const name = data?.full_name || 'Anfitrião';
  userName.textContent = name;

  if(data?.avatar_url){
    userAvatar.src = data.avatar_url + '?t=' + Date.now();
    userAvatar.style.display='block';
    userInitial.style.display='none';
  }else{
    userInitial.textContent = initials(name);
  }
}

btnLogout.onclick = async (e)=>{
  e.preventDefault();
  await sb.auth.signOut();
  location.href="index.html";
};

init();

/* =========================
   MENU HAMBÚRGUER (mobile)
   ========================= */
const menuToggle = document.getElementById('menuToggle');
const mobileMenu = document.getElementById('mobileMenu');
const menuClose = document.getElementById('menuClose');

function openMenu(){
  mobileMenu.classList.add('is-open');
  mobileMenu.setAttribute('aria-hidden','false');
  menuToggle.setAttribute('aria-expanded','true');
  document.body.style.overflow = 'hidden';
}
function closeMenu(){
  mobileMenu.classList.remove('is-open');
  mobileMenu.setAttribute('aria-hidden','true');
  menuToggle.setAttribute('aria-expanded','false');
  document.body.style.overflow = '';
}

menuToggle.addEventListener('click', ()=>{
  if(mobileMenu.classList.contains('is-open')) closeMenu();
  else openMenu();
});

menuClose.addEventListener('click', closeMenu);

/* fecha ao clicar fora do painel */
mobileMenu.addEventListener('click', (e)=>{
  if(e.target === mobileMenu) closeMenu();
});

/* fecha com ESC */
document.addEventListener('keydown', (e)=>{
  if(e.key === 'Escape' && mobileMenu.classList.contains('is-open')) closeMenu();
});
</script>

</body>
</html>
